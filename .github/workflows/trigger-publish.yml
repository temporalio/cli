name: 'Trigger Docker image build'

on:
  release:
    types: [published]

jobs:
  trigger:
    name: 'trigger Docker image build'
    runs-on: ubuntu-latest

    defaults:
      run:
        shell: bash

    steps:
      - name: Get git branch name
        id: get_branch
        run: |
          echo branch="${GITHUB_REF#refs/heads/}" >> "$GITHUB_OUTPUT"

      - name: Dispatch docker builds Github Action
        uses: temporalio/docker-builds/update-submodules.yml@main
        with:
          repo: "cli"
          branch: ${{ steps.get_branch.outputs.branch }}
          commit: ${{ env.GITHUB_SHA }}
